(window.webpackJsonp=window.webpackJsonp||[]).push([[185],{654:function(t,s,a){"use strict";a.r(s);var e=a(29),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"三步搞定-arm64-离线部署-kubernetess-kubesphere"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三步搞定-arm64-离线部署-kubernetess-kubesphere"}},[t._v("#")]),t._v(" 三步搞定 ARM64 离线部署 Kubernetess + KubeSphere "),a("Badge",{attrs:{text:"ARM64",type:"success"}})],1),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),a("p",[t._v("本文将主要介绍如何在 ARM64 环境下部署 Kubernetes 和 KubeSphere。")])]),t._v(" "),a("h2",{attrs:{id:"背景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#背景"}},[t._v("#")]),t._v(" 背景")]),t._v(" "),a("p",[t._v("随着我国对信息安全的愈发重视，国产化的趋势也越来越浓，包括国产操作系统、国产 CPU 等。由于 ARM 架构国产 CPU 在维持创新可信和先进性方面的潜在优势，其应用也将会越来越广泛。")]),t._v(" "),a("h2",{attrs:{id:"环境准备"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#环境准备"}},[t._v("#")]),t._v(" 环境准备")]),t._v(" "),a("p",[t._v("安装过程录屏地址："),a("a",{attrs:{href:"https://www.bilibili.com/video/BV1VL4y137Fn/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.bilibili.com/video/BV1VL4y137Fn/"),a("OutboundLink")],1)]),t._v(" "),a("h3",{attrs:{id:"节点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#节点"}},[t._v("#")]),t._v(" 节点")]),t._v(" "),a("p",[t._v("kubeSphere 支持的操作系统包括：")]),t._v(" "),a("ul",[a("li",[t._v("Ubuntu 16.04, 18.04")]),t._v(" "),a("li",[t._v("Debian Buster, Stretch")]),t._v(" "),a("li",[t._v("CentOS/RHEL 7")]),t._v(" "),a("li",[t._v("SUSE Linux Enterprise Server 15")]),t._v(" "),a("li",[t._v("openEuler")])]),t._v(" "),a("p",[t._v("准备已下三台 CentOS Linux release 7.9.2009 (AltArch) 为例：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("主机名")]),t._v(" "),a("th",[t._v("IP地址")]),t._v(" "),a("th",[t._v("角色")]),t._v(" "),a("th",[t._v("OS")]),t._v(" "),a("th",[t._v("配置")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("k8s-master")]),t._v(" "),a("td",[t._v("192.168.7.38")]),t._v(" "),a("td",[t._v("master")]),t._v(" "),a("td",[t._v("CentOS7.9")]),t._v(" "),a("td",[t._v("4核8G")])]),t._v(" "),a("tr",[a("td",[t._v("k8s-node1")]),t._v(" "),a("td",[t._v("192.168.7.20")]),t._v(" "),a("td",[t._v("worker")]),t._v(" "),a("td",[t._v("CentOS7.9")]),t._v(" "),a("td",[t._v("8核16G")])]),t._v(" "),a("tr",[a("td",[t._v("k8s-node2")]),t._v(" "),a("td",[t._v("192.168.7.187")]),t._v(" "),a("td",[t._v("worker")]),t._v(" "),a("td",[t._v("CentOS7.9")]),t._v(" "),a("td",[t._v("8核16G")])])])]),t._v(" "),a("h3",{attrs:{id:"端口要求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#端口要求"}},[t._v("#")]),t._v(" 端口要求")]),t._v(" "),a("p",[t._v("KubeSphere 需要某些端口用于服务之间的通信。如果您的网络配置有防火墙规则，则需要确保基础设施组件可以通过特定端口相互通信。这些端口用作某些进程或服务的通信端点。")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("服务")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("协议")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("行为")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("起始端口")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("结束端口")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("备注")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("ssh")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("TCP")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("allow")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("22")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}})]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("etcd")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("TCP")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("allow")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("2379")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("2380")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}})]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("apiserver")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("TCP")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("allow")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("6443")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}})]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("calico")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("TCP")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("allow")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("9099")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("9100")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}})]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("bgp")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("TCP")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("allow")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("179")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}})]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("nodeport")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("TCP")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("allow")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("30000")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("32767")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}})]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("master")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("TCP")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("allow")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("10250")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("10258")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}})]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("dns")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("TCP")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("allow")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("53")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}})]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("dns")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("UDP")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("allow")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("53")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}})]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("local-registry")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("TCP")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("allow")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("5000")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("离线环境需要")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("local-apt")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("TCP")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("allow")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("5080")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("离线环境需要")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("rpcbind")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("TCP")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("allow")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("111")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("使用 NFS 时需要")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("ipip")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("IPENCAP / IPIP")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("allow")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("Calico 需要使用 IPIP 协议")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[t._v("metrics-server")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("TCP")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("allow")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("8443")]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}}),t._v(" "),a("td",{staticStyle:{"text-align":"left"}})])])]),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),a("p",[t._v("当您使用 Calico 网络插件并且在云平台上使用经典网络运行集群时，您需要对源地址启用 IPENCAP 和 IPIP 协议。")])]),t._v(" "),a("h3",{attrs:{id:"依赖软件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#依赖软件"}},[t._v("#")]),t._v(" 依赖软件")]),t._v(" "),a("p",[t._v("确保机器已经安装所需依赖软件")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("yum "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" openssl ebtables socat ipset conntrack -y\n")])])]),a("h3",{attrs:{id:"安装docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装docker"}},[t._v("#")]),t._v(" 安装docker")]),t._v(" "),a("p",[t._v("Kubernetes默认的容器运行时仍然是Docker，使用的是kubelet中内置dockershim CRI实现。")]),t._v(" "),a("p",[t._v("安装所需依赖")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" yum "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -y yum-utils device-mapper-persistent-data lvm2\n")])])]),a("p",[t._v("配置docker yum源")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\n")])])]),a("p",[t._v("安装 Docker Engine-Community")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" yum "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" docker-ce docker-ce-cli containerd.io -y\n")])])]),a("p",[t._v("启动 Docker CE 并设置开机自启动")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" systemctl start "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" systemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("enable")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v("\n")])])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),a("p",[t._v("可将安装了所有依赖软件的操作系统制作成系统镜像使用，避免每台机器都安装依赖软件，即可提升交付部署效率，又可避免依赖问题的发生。")])]),t._v(" "),a("h3",{attrs:{id:"镜像仓库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#镜像仓库"}},[t._v("#")]),t._v(" 镜像仓库")]),t._v(" "),a("p",[t._v("可使用harbor或其他第三方镜像仓库。在接下来的安装步骤中，初始化环境过程我们使用kk创建自签名镜像仓库。")]),t._v(" "),a("h3",{attrs:{id:"安装包下载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装包下载"}},[t._v("#")]),t._v(" 安装包下载：")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),a("p",[t._v("该安装包仅包含 Kubernetes + KubeSphere-core 镜像，如需更多组件 arm64 镜像，可自行编译构建。")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# md5: 3ad57823faf2dfe945e2fe3dcfd4ace9")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -Ok https://kubesphere-installer.pek3b.qingstor.com/offline/v3.0.0/kubesphere-core-v3.0.0-offline-linux-arm64.tar.gz\n")])])]),a("h2",{attrs:{id:"安装步骤"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装步骤"}},[t._v("#")]),t._v(" 安装步骤：")]),t._v(" "),a("h3",{attrs:{id:"_1-创建集群配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-创建集群配置文件"}},[t._v("#")]),t._v(" 1.创建集群配置文件")]),t._v(" "),a("p",[t._v("安装包解压后进入"),a("code",[t._v("kubesphere-core-v3.0.0-offline-linux-arm64")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 解压")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("tar")]),t._v(" -zxvf kubesphere-core-v3.0.0-offline-linux-arm64.tar.gz\n")])])]),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@node1 kubesphere-core-v3.0.0-offline-linux-arm64"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ls -al ")]),t._v("\ntotal "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("55364")]),t._v("\ndrwxr-xr-x  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v(" root root     "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4096")]),t._v(" Mar  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(":27 "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\ndr-xr-x---. "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v(" root root     "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4096")]),t._v(" Mar  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v(":02 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("\ndrwxr-xr-x  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" root root     "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4096")]),t._v(" Oct "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("27")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2020")]),t._v(" charts\n-rw-r--r--  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" root root      "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("727")]),t._v(" Mar  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":35 config-sample.yaml\ndrwxr-xr-x  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" root root     "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4096")]),t._v(" Mar  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("17")]),t._v(":24 dependencies\n-rwxr-xr-x  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("56661021")]),t._v(" Dec  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2020")]),t._v(" kk\ndrwxr-xr-x  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" root root     "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4096")]),t._v(" Dec  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2020")]),t._v(" kubekey\ndrwxr-xr-x  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" root root     "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4096")]),t._v(" Dec "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2020")]),t._v(" kubesphere-images-v3.0.0\n")])])]),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("./kk create config --with-kubesphere v3.0.0\n")])])]),a("p",[t._v("根据实际环境信息修改生成的配置文件"),a("code",[t._v("config-sample.yaml")]),t._v("，也可使用-f参数自定义配置文件路径。kk 详细用法可参考："),a("a",{attrs:{href:"https://github.com/kubesphere/kubekey",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/kubesphere/kubekey"),a("OutboundLink")],1)]),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),a("p",[t._v("填写正确的私有仓库地址"),a("code",[t._v("privateRegistry")]),t._v("（如已准备好私有仓库可设置为已有仓库地址，若使用 kk 创建私有仓库，则该参数设置为："),a("code",[t._v("dockerhub.kubekey.local")]),t._v("）")])]),t._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("div",{staticClass:"highlight-lines"},[a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("div",{staticClass:"highlighted"},[t._v(" ")]),a("div",{staticClass:"highlighted"},[t._v(" ")]),a("div",{staticClass:"highlighted"},[t._v(" ")]),a("br"),a("br"),a("div",{staticClass:"highlighted"},[t._v(" ")]),a("br"),a("div",{staticClass:"highlighted"},[t._v(" ")]),a("br"),a("div",{staticClass:"highlighted"},[t._v(" ")]),a("div",{staticClass:"highlighted"},[t._v(" ")]),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("div",{staticClass:"highlighted"},[t._v(" ")]),a("br"),a("br"),a("br")]),a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" kubekey.kubesphere.io/v1alpha1\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Cluster\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" sample\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("hosts")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 注意指定节点 arch 为 arm64")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" k8s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("master"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("address")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 192.168.7.38"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("internalAddress")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 192.168.7.38"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("password")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Qcloud@123"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("arch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" arm64"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" k8s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("node1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("address")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 192.168.7.20"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("internalAddress")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 192.168.7.20"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("password")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Qcloud@123"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("arch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" arm64"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" k8s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("node2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("address")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 192.168.7.187"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("internalAddress")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 192.168.7.187"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("password")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Qcloud@123"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("arch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" arm64"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("roleGroups")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("etcd")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" k8s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("master\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("master")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" k8s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("master\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("worker")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" k8s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("node1\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" k8s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("node2\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("controlPlaneEndpoint")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("domain")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" lb.kubesphere.local\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("address")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("port")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("6443")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kubernetes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" v1.17.9\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("imageRepo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" kubesphere\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("clusterName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" cluster.local\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("network")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("plugin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" calico\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kubePodsCIDR")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 10.233.64.0/18\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kubeServiceCIDR")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 10.233.0.0/18\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("registry")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("registryMirrors")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("insecureRegistries")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 设置私有仓库")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("privateRegistry")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" dockerhub.kubekey.local\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("addons")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  \n")])])]),a("h3",{attrs:{id:"_2-环境初始化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-环境初始化"}},[t._v("#")]),t._v(" 2.环境初始化 "),a("Badge",{attrs:{text:"可选",type:"success"}})],1),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),a("p",[t._v("若已安装相关依赖，并且已经准备好镜像仓库，可略过该步骤。 (为避免依赖问题的产生，建议提前安装相关依赖或使用已安装相关依赖的系统镜像执行安装)")])]),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),a("p",[t._v("如需使用kk创建自签名镜像仓库，则会在当前机器启动docker registry服务，请确保当前机器存在"),a("code",[t._v("registry:2")]),t._v("，如没有，可从kubesphere-images-v3.0.0/registry.tar中导入。")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 导入命令：")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" load "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" registry.tar\n")])])])]),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),a("p",[t._v("由kk启动的镜像仓库端口为"),a("code",[t._v("443")]),t._v("，请确保所有机器均可访问当前机器"),a("code",[t._v("443")]),t._v("端口。镜像数据存储到本地"),a("code",[t._v("/mnt/registry")]),t._v(" (建议单独挂盘)。")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 执行如下命令会对配置文件中所有节点安装依赖：")]),t._v("\n./kk init os -f config-sample.yaml -s ./dependencies/\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 如需使用kk创建自签名镜像仓库，可执行如下命令：")]),t._v("\n./kk init os -f config-sample.yaml -s ./dependencies/ --add-images-repo\n")])])]),a("h3",{attrs:{id:"_3-导入镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-导入镜像"}},[t._v("#")]),t._v(" 3.导入镜像")]),t._v(" "),a("p",[t._v("进入"),a("code",[t._v("kubesphere-all-v3.0.0-offline-linux-arm64/kubesphere-images-v3.0.0")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@node1 kubesphere-images-v3.0.0"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ls -al ")]),t._v("\ntotal "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("24540")]),t._v("\ndrwxr-xr-x "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" root root     "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4096")]),t._v(" Dec "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2020")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\ndrwxr-xr-x "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v(" root root     "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4096")]),t._v(" Mar  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v(":45 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("\n-rw-r--r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" root root     "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2890")]),t._v(" Dec "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2020")]),t._v(" images-list-v3.0.0.txt\ndrwxr-xr-x "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" root root     "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4096")]),t._v(" Dec "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2020")]),t._v(" kubesphere-images\n-rwxr-xr-x "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" root root     "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("6762")]),t._v(" Nov "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2020")]),t._v(" offline-installation-tool.sh\n-rw------- "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("25104384")]),t._v(" Oct "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("27")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2020")]),t._v(" registry.tar\n")])])]),a("p",[t._v("使用 "),a("code",[t._v("offline-installation-tool.sh")]),t._v(" 将镜像导入之前准备的仓库中：")]),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),a("p",[t._v("脚本后镜像仓库地址请填写真实仓库地址："),a("code",[t._v("dockerhub.kubekey.local")])])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("./offline-installation-tool.sh -l images-list-v3.0.0.txt -d kubesphere-images -r dockerhub.kubekey.local\n")])])]),a("p",[t._v("使用kk创建自签名镜像仓库证书问题，如果遇到一下情况，可以通过修改docker.service 配置文件指定证书验证参数")]),t._v(" "),a("div",{staticClass:"custom-block danger"},[a("p",{staticClass:"custom-block-title"},[t._v("报错信息")]),t._v(" "),a("p",[t._v('Get "https://dockerhub.kubekey.local/v2/": x509: certificate relies on legacy Common Name field, use SANs or temporarily enable Common Name matching with GODEBUG=x509ignoreCN=0')])]),t._v(" "),a("p",[t._v("解决方法")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("vi")]),t._v(" /usr/lib/systemd/system/docker.service\n")])])]),a("p",[t._v("找到"),a("code",[t._v("[Service]")]),t._v("配置节点，下面追加如下内容：")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("div",{staticClass:"highlight-lines"},[a("br"),a("br"),a("div",{staticClass:"highlighted"},[t._v(" ")]),a("br"),a("br")]),a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("...\n[Service]\nEnvironment=GODEBUG=x509ignoreCN=0\n...\n")])])]),a("p",[t._v("重启docker服务")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("systemctl daemon-reload\nsystemctl restart docker.service\n")])])]),a("p",[t._v("详情参考："),a("a",{attrs:{href:"https://forum.gitlab.com/t/docker-push-to-gilab-registry-self-signed-certs-problem/52831/3",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://forum.gitlab.com/t/docker-push-to-gilab-registry-self-signed-certs-problem/52831/3"),a("OutboundLink")],1)]),t._v(" "),a("h3",{attrs:{id:"_4-执行安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-执行安装"}},[t._v("#")]),t._v(" 4.执行安装")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),a("p",[t._v("以上准备工作完成且再次检查配置文件无误后，执行安装。")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("./kk create cluster -f config-sample.yaml --with-kubesphere\n")])])]),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),a("p",[t._v("如果中途安装失败执行如下命令删除集群以后再重新执行安装命令")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("./kk delete cluster -f config-sample.yaml\n")])])])]),t._v(" "),a("p",[t._v("安装完成后控制台输出内容如下：")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#####################################################")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("###              Welcome to KubeSphere!           ###")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#####################################################")]),t._v("\n\nConsole: http://192.168.7.38:30880\nAccount: admin\nPassword: P@88w0rd\n\nNOTES：\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(". After logging into the console, please check the\n     monitoring status of "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("service")]),t._v(" components "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v("\n     the "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Cluster Management"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v(" If any "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("service")]),t._v(" is not\n     ready, please "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("wait")]),t._v(" patiently "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("until")]),t._v(" all components \n     are ready.\n  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(". Please modify the default password after login.\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#####################################################")]),t._v("\nhttps://kubesphere.io             "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("-03-04 03:34:18\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#####################################################")]),t._v("\nINFO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("02:16:07 CST"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Installation is complete.\n\nPlease check the result using the command:\n\n       kubectl logs -n kubesphere-system "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),t._v("kubectl get pod -n kubesphere-system -l "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("app")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ks-install -o "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("jsonpath")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{.items[0].metadata.name}'")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v(" -f\n\n")])])]),a("p",[t._v("安装日志查看")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("kubectl logs -n kubesphere-system "),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$(")]),t._v("kubectl get pod -n kubesphere-system -l "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("app")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ks-install -o "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("jsonpath")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{.items[0].metadata.name}'")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v(")")])]),t._v(" -f\n")])])]),a("h3",{attrs:{id:"_5-查看结果"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-查看结果"}},[t._v("#")]),t._v(" 5.查看结果")]),t._v(" "),a("p",[t._v("打开浏览器访问KubeSphere管控台：http://117.78.8.124:30880/login")]),t._v(" "),a("blockquote",[a("p",[t._v("Account: "),a("code",[t._v("admin")])]),t._v(" "),a("p",[t._v("Password: "),a("code",[t._v("P@88w0rd")])])]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2022-03-04_035131.png",alt:"img"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2022-03-04_035156.png",alt:"img"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2022-03-04_035213.png",alt:"img"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2022-03-04_035240.png",alt:"img"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2022-03-04_035311.png",alt:"img"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2022-03-04_035322.png",alt:"img"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2022-03-04_035334.png",alt:"img"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/2022-03-04_035351.png",alt:"img"}})])])}),[],!1,null,null,null);s.default=n.exports}}]);