(window.webpackJsonp=window.webpackJsonp||[]).push([[102],{571:function(t,e,r){"use strict";r.r(e);var a=r(29),s=Object(a.a)({},(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[r("h1",{attrs:{id:"使用certbot生成let-s-encrypt证书"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#使用certbot生成let-s-encrypt证书"}},[t._v("#")]),t._v(" 使用Certbot生成Let's Encrypt证书")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://letsencrypt.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Let's Encrypt"),r("OutboundLink")],1),t._v(" 是一个新的免费的，自动的，开源的认证中心。")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://certbot.eff.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Certbot"),r("OutboundLink")],1),t._v("是Let's Encrypt的基于控制台的证书生成工具。")]),t._v(" "),r("p",[t._v("本文我们将使用Certbot生成Let's Encrypt证书。该证书将被部署在Minio服务器中使用。")]),t._v(" "),r("h2",{attrs:{id:"_1-前提条件"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_1-前提条件"}},[t._v("#")]),t._v(" 1. 前提条件")]),t._v(" "),r("ul",[r("li",[r("p",[t._v("从"),r("a",{attrs:{href:"https://docs.minio.io/docs/minio-quickstart-guide",target:"_blank",rel:"noopener noreferrer"}},[t._v("这里"),r("OutboundLink")],1),t._v("下载并安装Minio Server。")])]),t._v(" "),r("li",[r("p",[t._v("从"),r("a",{attrs:{href:"https://certbot.eff.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("这里"),r("OutboundLink")],1),t._v("下载并安装Certbot。")]),t._v(" "),r("h2",{attrs:{id:"_2-依赖"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2-依赖"}},[t._v("#")]),t._v(" 2. 依赖")])]),t._v(" "),r("li",[r("p",[t._v("执行certbot时，需要打开443端口并确保可以访问。")])]),t._v(" "),r("li",[r("p",[t._v("Certbot需要有root权限，因为只有root才允许绑定1024以下的端口。")])]),t._v(" "),r("li",[r("p",[t._v("本文我们将使用myminio.com这个域名，请在设置时改成你自己的域名。")]),t._v(" "),r("h2",{attrs:{id:"_3-步骤"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_3-步骤"}},[t._v("#")]),t._v(" 3. 步骤")])])]),t._v(" "),r("h3",{attrs:{id:"步骤1-安装certbot"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#步骤1-安装certbot"}},[t._v("#")]),t._v(" 步骤1: 安装Certbot")]),t._v(" "),r("p",[t._v("参考"),r("a",{attrs:{href:"https://certbot.eff.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("这里"),r("OutboundLink")],1),t._v("安装Certbot。")]),t._v(" "),r("h3",{attrs:{id:"步骤2-生成let-s-encrypt证书"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#步骤2-生成let-s-encrypt证书"}},[t._v("#")]),t._v(" 步骤2: 生成Let's Encrypt证书")]),t._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[t._v("# certbot certonly --standalone -d myminio.com --staple-ocsp -m test@yourdomain.io --agree-tos\n")])])]),r("h3",{attrs:{id:"步骤3-验证证书"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#步骤3-验证证书"}},[t._v("#")]),t._v(" 步骤3: 验证证书")]),t._v(" "),r("p",[t._v("列出"),r("code",[t._v("/etc/letsencrypt/live/myminio.com")]),t._v("里的证书。")]),t._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[t._v("$ ls -l /etc/letsencrypt/live/myminio.comtotal 4lrwxrwxrwx 1 root root  37 Aug  2 09:58 cert.pem -> ../../archive/myminio.com/cert4.pemlrwxrwxrwx 1 root root  38 Aug  2 09:58 chain.pem -> ../../archive/myminio.com/chain4.pemlrwxrwxrwx 1 root root  42 Aug  2 09:58 fullchain.pem -> ../../archive/myminio.com/fullchain4.pemlrwxrwxrwx 1 root root  40 Aug  2 09:58 privkey.pem -> ../../archive/myminio.com/privkey4.pem-rw-r--r-- 1 root root 543 May 10 22:07 README\n")])])]),r("h3",{attrs:{id:"步骤4-使用证书给minio-server设置ssl。"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#步骤4-使用证书给minio-server设置ssl。"}},[t._v("#")]),t._v(" 步骤4: 使用证书给Minio Server设置SSL。")]),t._v(" "),r("p",[t._v("Certbot生成的证书和key需要放到用户的home文件夹里。")]),t._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[t._v("$ cp /etc/letsencrypt/live/myminio.com/fullchain.pem /home/user/.minio/certs/public.crt$ cp /etc/letsencrypt/live/myminio.com/privkey.pem /home/user/.minio/certs/private.key\n")])])]),r("h3",{attrs:{id:"步骤5-修改证书的ownership。"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#步骤5-修改证书的ownership。"}},[t._v("#")]),t._v(" 步骤5: 修改证书的ownership。")]),t._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[t._v("$ sudo chown user:user /home/user/.minio/certs/private.key$ sudo chown user:user /home/user/.minio/certs/public.crt\n")])])]),r("h3",{attrs:{id:"步骤6-使用https启动minio-server。"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#步骤6-使用https启动minio-server。"}},[t._v("#")]),t._v(" 步骤6: 使用HTTPS启动Minio Server。")]),t._v(" "),r("p",[t._v("启动Minio Server,使用443端口。")]),t._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[t._v('$ sudo ./minio server --address ":443" /mnt/data\n')])])]),r("p",[t._v("如果你用的是Minio Docker版，则你需要")]),t._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[t._v('$ sudo docker run -p 443:443 -v /home/user/.minio:/root/.minio/ -v /home/user/data:/data minio/minio server --address ":443" /data\n')])])]),r("h3",{attrs:{id:"步骤7-通过浏览器访问https-myminio-com。"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#步骤7-通过浏览器访问https-myminio-com。"}},[t._v("#")]),t._v(" 步骤7: 通过浏览器访问"),r("a",{attrs:{href:"https://myminio.com./",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://myminio.com。"),r("OutboundLink")],1)]),t._v(" "),r("p",[r("img",{attrs:{src:"/img/2021-08-23_151102.png",alt:"Letsencrypt"}})]),t._v(" "),r("blockquote",[r("p",[t._v("原文: https://docs.min.io/docs/generate-let-s-encypt-certificate-using-concert-for-minio.html")])])])}),[],!1,null,null,null);e.default=s.exports}}]);