(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{516:function(s,t,a){"use strict";a.r(t);var e=a(29),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"centos7-lvm操作实战"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#centos7-lvm操作实战"}},[s._v("#")]),s._v(" CentOS7 LVM操作实战")]),s._v(" "),a("h2",{attrs:{id:"lvm简介"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lvm简介"}},[s._v("#")]),s._v(" LVM简介")]),s._v(" "),a("p",[s._v("LVM是"),a("strong",[s._v("逻辑盘卷管理")]),s._v("（LogicalVolumeManager）的简称，它是"),a("strong",[s._v("Linux环境")]),s._v("下对磁盘分区进行管理的一种机制，LVM是建立在"),a("strong",[s._v("硬盘和分区")]),s._v("之上的一个"),a("strong",[s._v("逻辑层")]),s._v("，来提高磁盘分区管理的灵活性。通过LVM系统管理员可以轻松管理磁盘分区，如：将"),a("strong",[s._v("若干个磁盘分区")]),s._v("连接为一个"),a("strong",[s._v("整块的卷组")]),s._v(" （volumegroup），形成一个存储池。管理员可以在卷组上随意创建逻辑卷组（logicalvolumes），并进一步在逻辑卷组上创建文件系统。")]),s._v(" "),a("ul",[a("li",[a("p",[a("strong",[s._v("LVM是 Logical Volume Manager(逻辑卷管理)的简写")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("PV:是物理的磁盘分区")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("VG:LVM中的物理的磁盘分区，也就是PV，必须加入VG，可以将VG理解为一个仓库统一管理了几个大的硬盘，形成了一个统一虚拟的存储资源池。")])])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("LV：也就是从VG中划分的逻辑分区")])])])]),s._v(" "),a("p",[s._v("抽象模型如下:")]),s._v(" "),a("p",[a("img",{attrs:{src:"/img/2021-05-28_220813.jpg",alt:"LVM简介"}})]),s._v(" "),a("h2",{attrs:{id:"lvm相关概念和机制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lvm相关概念和机制"}},[s._v("#")]),s._v(" LVM相关概念和机制")]),s._v(" "),a("p",[s._v("LVM(Logical Volume Manager)可以让分区变得弹性，可以随时随地的扩大和缩小分区大小，前提是该分区是LVM格式的。")]),s._v(" "),a("p",[s._v("lvm需要使用的软件包为"),a("code",[s._v("lvm2")]),s._v("，一般在CentOS发行版中都已经预安装了。")]),s._v(" "),a("h3",{attrs:{id:"pv-physical-volume-即物理卷"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pv-physical-volume-即物理卷"}},[s._v("#")]),s._v(" PV(Physical Volume)即物理卷")]),s._v(" "),a("p",[s._v("硬盘分区后(还未格式化为文件系统)使用"),a("code",[s._v("pvcreate")]),s._v("命令可以将分区创建为"),a("code",[s._v("PV")]),s._v("，要求分区的system ID为8e，即为LVM格式的系统标识符。")]),s._v(" "),a("h3",{attrs:{id:"vg-volume-group-即卷组"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vg-volume-group-即卷组"}},[s._v("#")]),s._v(" VG(Volume Group)即卷组")]),s._v(" "),a("p",[s._v("将多个"),a("code",[s._v("PV")]),s._v("组合起来，使用"),a("code",[s._v("vgcreate")]),s._v("命令创建成卷组，这样卷组包含了多个PV就比较大了，相当于重新整合了多个分区后得到的磁盘。虽然"),a("code",[s._v("VG")]),s._v("是整合多个"),a("code",[s._v("PV")]),s._v("的，但是创建"),a("code",[s._v("VG")]),s._v("时会将"),a("code",[s._v("VG")]),s._v("所有的空间根据指定的"),a("code",[s._v("PE")]),s._v("大小划分为多个"),a("code",[s._v("PE")]),s._v("，在LVM模式下的存储都以"),a("code",[s._v("PE")]),s._v("为单元，类似于文件系统的Block。")]),s._v(" "),a("h3",{attrs:{id:"pe-physical-extend"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pe-physical-extend"}},[s._v("#")]),s._v(" PE(Physical Extend)")]),s._v(" "),a("p",[a("code",[s._v("PE")]),s._v("是"),a("code",[s._v("VG")]),s._v("中的存储单元。实际存储的数据都是存储在这里面的。")]),s._v(" "),a("h3",{attrs:{id:"lv-logical-volume"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lv-logical-volume"}},[s._v("#")]),s._v(" LV(Logical Volume)")]),s._v(" "),a("p",[a("code",[s._v("VG")]),s._v("相当于整合过的硬盘，那么"),a("code",[s._v("LV")]),s._v("就相当于分区，只不过该分区是通过"),a("code",[s._v("VG")]),s._v("来划分的。"),a("code",[s._v("VG")]),s._v("中有很多"),a("code",[s._v("PE")]),s._v("单元，可以指定将多少个"),a("code",[s._v("PE")]),s._v("划分给一个"),a("code",[s._v("LV")]),s._v("，也可以直接指定大小(如多少兆)来划分。划分为LV之后就相当于划分了分区，只需再对"),a("code",[s._v("LV")]),s._v("进行格式化即可变成普通的文件系统。")]),s._v(" "),a("p",[s._v("通俗地讲，非LVM管理的分区步骤是将硬盘分区，然后将分区格式化为文件系统。而使用LVM，则是在硬盘分区为特定的LVM标识符的分区后将其转变为LVM可管理的"),a("code",[s._v("PV")]),s._v("，其实"),a("code",[s._v("PV")]),s._v("仍然类似于分区，然后将几个"),a("code",[s._v("PV")]),s._v("整合为类似于磁盘的"),a("code",[s._v("VG")]),s._v("，最后划分"),a("code",[s._v("VG")]),s._v("为"),a("code",[s._v("LV")]),s._v("，此时"),a("code",[s._v("LV")]),s._v("就成了LVM可管理的分区，只需再对其格式化即可成为文件系统。")]),s._v(" "),a("h3",{attrs:{id:"le-logical-extent"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#le-logical-extent"}},[s._v("#")]),s._v(" LE(logical extent)")]),s._v(" "),a("p",[s._v("PE是物理存储单元，而LE则是逻辑存储单元，也即为"),a("code",[s._v("LV")]),s._v("中的逻辑存储单元，和"),a("code",[s._v("PE")]),s._v("的大小是一样的。从"),a("code",[s._v("VG")]),s._v("中划分"),a("code",[s._v("LV")]),s._v("，实际上是从"),a("code",[s._v("VG")]),s._v("中划分"),a("code",[s._v("VG")]),s._v("中的"),a("code",[s._v("PE")]),s._v("，只不过划分"),a("code",[s._v("LV")]),s._v("后它不再称为"),a("code",[s._v("PE")]),s._v("，而是成为le。")]),s._v(" "),a("p",[s._v("LVM之所以能够伸缩容量，其实现的方法就是将"),a("code",[s._v("LV")]),s._v("里空闲的"),a("code",[s._v("PE")]),s._v("移出，或向LV中添加空闲的"),a("code",[s._v("PE")]),s._v("。")]),s._v(" "),a("h2",{attrs:{id:"lvm的写入机制"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lvm的写入机制"}},[s._v("#")]),s._v(" LVM的写入机制")]),s._v(" "),a("p",[s._v("LV是从VG中划分出来的，LV中的"),a("code",[s._v("PE")]),s._v("很可能来自于多个"),a("code",[s._v("PV")]),s._v("。在向LV存储数据时，有多种存储机制，其中两种是：")]),s._v(" "),a("p",[s._v("线性模式(linear)：先写完来自于同一个PV的"),a("code",[s._v("PE")]),s._v("，再写来自于下一个PV的"),a("code",[s._v("PE")]),s._v("。")]),s._v(" "),a("p",[s._v("条带模式(striped)：一份数据拆分成多份，分别写入该LV对应的每个PV中，所以读写性能较好，类似于RAID 0。")]),s._v(" "),a("p",[s._v("尽管striped读写性能较好也不建议使用该模式，因为lvm的着重点在于弹性容量扩展而非性能，要实现性能应该使用RAID来实现，而且使用striped模式时要进行容量的扩展和收缩将比较麻烦。默认的是使用线性模式。")]),s._v(" "),a("h2",{attrs:{id:"lvm详解图"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#lvm详解图"}},[s._v("#")]),s._v(" LVM详解图")]),s._v(" "),a("p",[a("img",{attrs:{src:"/img/2021-05-28_220888.jpg",alt:"LVM详解图"}})]),s._v(" "),a("h2",{attrs:{id:"操作实战"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#操作实战"}},[s._v("#")]),s._v(" 操作实战")]),s._v(" "),a("p",[s._v("通过在虚拟机的CentOS7上创建LVM ，使用"),a("code",[s._v("LV")]),s._v("，扩容"),a("code",[s._v("LV")]),s._v("，缩减"),a("code",[s._v("LV")]),s._v("实战来了解LVM及熟悉对LVM的操作。")]),s._v(" "),a("p",[s._v("准备工作准备虚拟机，操作系统为CentOS7，初始40G的硬盘")]),s._v(" "),a("p",[a("img",{attrs:{src:"/img/2021-05-28_170223.png",alt:"虚拟机"}})]),s._v(" "),a("p",[s._v("初始状态共20G的系统盘")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# df -h")]),s._v("\nFilesystem               Size  Used Avail Use% Mounted on\ndevtmpfs                 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /dev\ntmpfs                    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /dev/shm\ntmpfs                    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(".6M  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("% /run\ntmpfs                    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /sys/fs/cgroup\n/dev/mapper/centos-root   35G  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".3G   32G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("% /\n/dev/sda1                976M  108M  802M  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v("% /boot\ntmpfs                    396M     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  396M   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /run/user/0\n")])])]),a("p",[s._v("接下来，关闭虚拟机并添加两块硬盘，大小设置100GB")]),s._v(" "),a("p",[a("img",{attrs:{src:"/img/2021-05-28_172250.png",alt:"新增硬盘"}})]),s._v(" "),a("p",[s._v("启动虚拟机通过pvs命令查看物理卷的情况，目前只看到有虚拟机初始安装时有个pv为"),a("code",[s._v("/dv/sda2")]),s._v(" vg为"),a("code",[s._v("centso")]),s._v("的物理卷 大小为"),a("code",[s._v("40G")])]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# pvs")]),s._v("\n  PV         VG     Fmt  Attr PSize   PFree\n  /dev/sda2  centos lvm2 a--  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("39")]),s._v(".00g "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(".00m\n")])])]),a("p",[s._v("通过"),a("code",[s._v("fdisk -l")]),s._v(" 可以看到新加的两个盘大小分别都是"),a("code",[s._v("100G")]),s._v("。我们将用这两个盘组成一个vg，进行lvm的管理。")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("div",{staticClass:"highlight-lines"},[a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("br"),a("br"),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br")]),a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# fdisk -l")]),s._v("\n\nDisk /dev/sda: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("42.9")]),s._v(" GB, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("42949672960")]),s._v(" bytes, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("83886080")]),s._v(" sectors\nUnits "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sectors of "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" * "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nSector size "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("logical/physical"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes / "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nI/O size "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("minimum/optimal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes / "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nDisk label type: dos\nDisk identifier: 0x000cbb0e\n\n   Device Boot      Start         End      Blocks   Id  System\n/dev/sda1   *        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2048")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2099199")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1048576")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("83")]),s._v("  Linux\n/dev/sda2         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2099200")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("83886079")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("40893440")]),s._v("   8e  Linux LVM\n\nDisk /dev/sdb: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("107.4")]),s._v(" GB, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("107374182400")]),s._v(" bytes, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("209715200")]),s._v(" sectors\nUnits "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sectors of "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" * "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nSector size "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("logical/physical"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes / "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nI/O size "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("minimum/optimal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes / "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\n\n\nDisk /dev/sdc: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("107.4")]),s._v(" GB, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("107374182400")]),s._v(" bytes, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("209715200")]),s._v(" sectors\nUnits "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sectors of "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" * "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nSector size "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("logical/physical"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes / "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nI/O size "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("minimum/optimal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes / "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\n\n\nDisk /dev/mapper/centos-root: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("37.7")]),s._v(" GB, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("37706792960")]),s._v(" bytes, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("73646080")]),s._v(" sectors\nUnits "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sectors of "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" * "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nSector size "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("logical/physical"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes / "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nI/O size "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("minimum/optimal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes / "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\n\n\nDisk /dev/mapper/centos-swap: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4160")]),s._v(" MB, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4160749568")]),s._v(" bytes, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8126464")]),s._v(" sectors\nUnits "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sectors of "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" * "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nSector size "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("logical/physical"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes / "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nI/O size "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("minimum/optimal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes / "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\n")])])]),a("h2",{attrs:{id:"创建lvm逻辑卷"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建lvm逻辑卷"}},[s._v("#")]),s._v(" 创建LVM逻辑卷")]),s._v(" "),a("p",[s._v("1、将物理硬盘格式化成"),a("code",[s._v("PV")]),s._v("（物理卷） 使用的是"),a("code",[s._v("pvcreate")]),s._v("命令"),a("code",[s._v("pvcreate /dev/sdb /dev/sdc")]),s._v(" (将/dev/sdb /dev/sdc两块硬盘创建为物理卷)")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# pvcreate /dev/sdb /dev/sdc")]),s._v("\n  Physical volume "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/dev/sdb"')]),s._v(" successfully created.\n  Physical volume "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/dev/sdc"')]),s._v(" successfully created.\n")])])]),a("p",[s._v("通过"),a("code",[s._v("pvdisplay")]),s._v("或"),a("code",[s._v("pvs")]),s._v("查看当前的"),a("code",[s._v("PV")]),s._v("信息，可以看到两块"),a("code",[s._v("100G")]),s._v("的物理卷已经成功创建")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("div",{staticClass:"highlight-lines"},[a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("br"),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("br")]),a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# pvdisplay")]),s._v("\n  --- Physical volume ---\n  PV Name               /dev/sda2\n  VG Name               centos\n  PV Size               "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("39.00")]),s._v(" GiB / not usable "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.00")]),s._v(" MiB\n  Allocatable           "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v(" \n  PE Size               "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.00")]),s._v(" MiB\n  Total PE              "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9983")]),s._v("\n  Free PE               "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n  Allocated PE          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("9982")]),s._v("\n  PV UUID               uT8J7D-rCmM-npfd-Cfzc-HDXf-3oGz-cx0sI8\n   \n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/dev/sdb"')]),s._v(" is a new physical volume of "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"100.00 GiB"')]),s._v("\n  --- NEW Physical volume ---\n  PV Name               /dev/sdb\n  VG Name               \n  PV Size               "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100.00")]),s._v(" GiB\n  Allocatable           NO\n  PE Size               "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("   \n  Total PE              "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n  Free PE               "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n  Allocated PE          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n  PV UUID               XcglBd-zjL5-SGRC-4F5i-huhz-2mac-DECnQA\n   \n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/dev/sdc"')]),s._v(" is a new physical volume of "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"100.00 GiB"')]),s._v("\n  --- NEW Physical volume ---\n  PV Name               /dev/sdc\n  VG Name               \n  PV Size               "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100.00")]),s._v(" GiB\n  Allocatable           NO\n  PE Size               "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("   \n  Total PE              "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n  Free PE               "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n  Allocated PE          "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n  PV UUID               bgqoKV-1ncH-VqjQ-tpT3-KxEb-oiQl-UPvq9h\n")])])]),a("p",[s._v("2、创建卷组（VG），并将"),a("code",[s._v("PV")]),s._v("加入到卷组中 通过"),a("code",[s._v("vgcreate")]),s._v("命令"),a("code",[s._v("vgcreate vg /dev/sdb /dev/sdc")])]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vgcreate vg /dev/sdb /dev/sdc")]),s._v("\n  Volume group "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"vg"')]),s._v(" successfully created\n")])])]),a("p",[s._v("通过"),a("code",[s._v("vgdisplay")]),s._v("或"),a("code",[s._v("vgs")]),s._v("命令查看vg的信息。看到vg已经创建好了，大小是两个pv的大大小也就是100G+100G，大概是200G的样子，这里显示199.99G")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vgs")]),s._v("\n  VG     "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#PV #LV #SN Attr   VSize   VFree  ")]),s._v("\n  centos   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" wz--n- "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("39")]),s._v(".00g   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(".00m\n  vg       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" wz--n- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("199")]),s._v(".99g "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("199")]),s._v(".99g\n")])])]),a("p",[s._v("3、基于卷组（VG）创建逻辑卷(LV) 通过"),a("code",[s._v("lvcreate")]),s._v("命令"),a("code",[s._v("lvcreate -n app -L 50G vg")]),s._v(" (基于vg创建逻辑卷lv,名字为app,大小为50G)")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# lvcreate -n app -L 50G vg")]),s._v("\n  Logical volume "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"app"')]),s._v(" created.\n")])])]),a("p",[s._v("用"),a("code",[s._v("lvdisplay")]),s._v("或"),a("code",[s._v("lvs")]),s._v("命令查看创建好的逻辑卷。可以看到名字为app的逻辑卷lv已经创建好了，它是基于vg创建的，大小为50G")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# lvs")]),s._v("\n  LV   VG     Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert\n  root centos -wi-ao---- "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("35")]),s._v(".12g                                                    \n  swap centos -wi-ao----  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(".88g                                                    \n  app  vg     -wi-a-----  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v(".00g   \n")])])]),a("p",[s._v("到这里，lv就创建好了，但是要用起来，还得格式化并挂载到我们的文件系统。")]),s._v(" "),a("h2",{attrs:{id:"格式化并使用逻辑卷"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#格式化并使用逻辑卷"}},[s._v("#")]),s._v(" 格式化并使用逻辑卷")]),s._v(" "),a("p",[s._v("1、格式化 "),a("code",[s._v("mkfs -t ext4 /dev/vg/app")]),s._v(" 用ext4的格式格式化"),a("code",[s._v("/dev/vg/app")])]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkfs -t ext4 /dev/vg/app")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mke2fs")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.42")]),s._v(".9 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v("-Dec-2013"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nFilesystem "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("label")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\nOS type: Linux\nBlock "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("log"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nFragment "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("size")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("log"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Stride")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" blocks, Stripe "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("width")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" blocks\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3276800")]),s._v(" inodes, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13107200")]),s._v(" blocks\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("655360")]),s._v(" blocks "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.00")]),s._v("%"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" reserved "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" the super user\nFirst data "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("block")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nMaximum filesystem "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("blocks")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2162163712")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("400")]),s._v(" block "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("groups")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32768")]),s._v(" blocks per group, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32768")]),s._v(" fragments per group\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8192")]),s._v(" inodes per group\nSuperblock backups stored on blocks: \n        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32768")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("98304")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("163840")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("229376")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("294912")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("819200")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("884736")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1605632")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2654208")]),s._v(", \n        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096000")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7962624")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11239424")]),s._v("\n\nAllocating group tables: "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("                            \nWriting inode tables: "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("                            \nCreating journal "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("32768")]),s._v(" blocks"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\nWriting superblocks and filesystem accounting information: "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("  \n")])])]),a("p",[s._v("2、挂载 创建挂载点 "),a("code",[s._v("mkdir /app")]),s._v(" 将"),a("code",[s._v("/dev/vg/app")]),s._v(" 挂载到"),a("code",[s._v("/app")])]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mount")]),s._v(" /dev/vg/app /app\n")])])]),a("p",[s._v("然后"),a("code",[s._v("df -h")]),s._v(" 可以看到已经挂载到"),a("code",[s._v("/app")]),s._v("下了 ，大小为lv 的大小50G")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# df -h")]),s._v("\nFilesystem               Size  Used Avail Use% Mounted on\ndevtmpfs                 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /dev\ntmpfs                    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /dev/shm\ntmpfs                    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(".6M  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("% /run\ntmpfs                    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /sys/fs/cgroup\n/dev/mapper/centos-root   35G  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".3G   32G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("% /\n/dev/sda1                976M  108M  802M  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v("% /boot\ntmpfs                    396M     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  396M   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /run/user/0\n/dev/mapper/vg-app        50G   53M   47G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("% /app\n")])])]),a("p",[s._v("进入"),a("code",[s._v("/app")]),s._v("目录执行命令"),a("code",[s._v("touch test.txt")]),s._v(" 创建一个测试文件"),a("code",[s._v("test.txt")]),s._v("，可以看到该挂载点是可以用了。")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# touch test.txt")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll")]),s._v("\ntotal "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n-rw-r--r--. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" May "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":50 test.txt\n")])])]),a("p",[s._v("设置开机加载")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/dev/vg/app /app ext4 defaults 0 0"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v("/etc/fstab\n")])])]),a("h2",{attrs:{id:"扩容逻辑卷"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#扩容逻辑卷"}},[s._v("#")]),s._v(" 扩容逻辑卷")]),s._v(" "),a("p",[s._v("这里扩容分两种情况，一种情况是vg还有足够的空间，那么就可以直接扩lv就可以了。另外一种情况是要扩的空间已经超过了vg的大小，那么就可以通过加物理磁盘扩充到vg里，然后再扩lv。")]),s._v(" "),a("h3",{attrs:{id:"第一种情况-扩的空间大小在vg的容量范围之内"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第一种情况-扩的空间大小在vg的容量范围之内"}},[s._v("#")]),s._v(" 第一种情况，扩的空间大小在vg的容量范围之内")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vgs")]),s._v("\n  VG     "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#PV #LV #SN Attr   VSize   VFree  ")]),s._v("\n  centos   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" wz--n- "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("39")]),s._v(".00g   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(".00m\n  vg       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" wz--n- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("199")]),s._v(".99g "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("149")]),s._v(".99g\n")])])]),a("p",[s._v("现在vg的大小为200G，现在/app是50G，计划扩到80G，没有超过vg的大小那么可以直接扩lv就可以了。")]),s._v(" "),a("p",[s._v("第一步：首先卸载设备和挂载点的关联")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("umount")]),s._v(" /app\n")])])]),a("p",[s._v("第二步：将逻辑卷"),a("code",[s._v("/dev/vg/app")]),s._v(" 扩展到80G "),a("code",[s._v("lvextend -L 80G /dev/vg/app")]),s._v(" 可以清楚的看到vg/app从50G扩容到了80G")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# lvextend -L 80G /dev/vg/app")]),s._v("\n  Size of logical volume vg/app changed from "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("50.00")]),s._v(" GiB "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12800")]),s._v(" extents"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" to "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80.00")]),s._v(" GiB "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20480")]),s._v(" extents"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".\n  Logical volume vg/app successfully resized.\n")])])]),a("p",[s._v("第三步：检查硬盘（lv）完整性，并重置硬盘(lv)容量 "),a("code",[s._v("e2fsck -f /dev/vg/app")]),s._v(" 检查硬盘完整性")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# e2fsck -f /dev/vg/app")]),s._v("\ne2fsck "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.42")]),s._v(".9 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v("-Dec-2013"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nPass "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(": Checking inodes, blocks, and sizes\nPass "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(": Checking directory structure\nPass "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(": Checking directory connectivity\nPass "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(": Checking reference counts\nPass "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(": Checking group summary information\n/dev/vg/app: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v("/3276800 files "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("% non-contiguous"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("251790")]),s._v("/13107200 blocks\n")])])]),a("p",[a("code",[s._v("resize2fs /dev/vg/app")]),s._v(" 重置硬盘(lv)容量，"),a("strong",[s._v("这一步必需要做")]),s._v("，否则即使扩了容量，但看到的还是扩容之前的容量。")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# resize2fs /dev/vg/app")]),s._v("\nresize2fs "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.42")]),s._v(".9 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v("-Dec-2013"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nResizing the filesystem on /dev/vg/app to "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20971520")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("4k"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" blocks.\nThe filesystem on /dev/vg/app is now "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20971520")]),s._v(" blocks long.\n")])])]),a("p",[s._v("第四步：重新挂载硬盘并查看 "),a("code",[s._v("mount -a")]),s._v("并执行"),a("code",[s._v("df -h")]),s._v(" 可以看到"),a("code",[s._v("/app")]),s._v("已经成功扩容到80G了")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mount -a")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# df -h")]),s._v("\nFilesystem               Size  Used Avail Use% Mounted on\ndevtmpfs                 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /dev\ntmpfs                    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /dev/shm\ntmpfs                    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(".6M  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("% /run\ntmpfs                    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /sys/fs/cgroup\n/dev/mapper/centos-root   35G  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".3G   32G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("% /\n/dev/sda1                976M  108M  802M  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v("% /boot\ntmpfs                    396M     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  396M   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /run/user/0\n/dev/mapper/vg-app        79G   56M   75G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("% /app\n")])])]),a("p",[a("code",[s._v("ls")]),s._v(" 查看"),a("code",[s._v("/app")]),s._v("里面的文件还在，说明扩容对文件数据没有啥影响。")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost app"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\ntest.txt\n")])])]),a("p",[s._v("如果扩容的大小超过了vg的大小怎么办呢？可以通过扩硬件的方式，加块硬盘到vg然后再扩lv。")]),s._v(" "),a("h3",{attrs:{id:"第二种情况-扩容的大小超过了vg的大小"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第二种情况-扩容的大小超过了vg的大小"}},[s._v("#")]),s._v(" 第二种情况，扩容的大小超过了vg的大小")]),s._v(" "),a("p",[s._v("现在vg的大小为200G，现在/app是80G，计划扩到350G，已经没有超过vg的200G大小那么就需要先加硬盘，然后扩vg，再扩lv。")]),s._v(" "),a("p",[s._v("第一步：添加硬盘")]),s._v(" "),a("p",[a("img",{attrs:{src:"/img/2021-05-28_183857.png",alt:"新增200G硬盘"}})]),s._v(" "),a("p",[s._v("通过"),a("code",[s._v("fdisk -l")]),s._v("命令查看添加")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("div",{staticClass:"highlight-lines"},[a("br"),a("br"),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br")]),a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# fdisk -l")]),s._v("\n\nDisk /dev/sdd: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("214.7")]),s._v(" GB, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("214748364800")]),s._v(" bytes, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("419430400")]),s._v(" sectors\nUnits "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sectors of "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" * "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nSector size "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("logical/physical"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes / "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nI/O size "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("minimum/optimal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes / "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\n\n\nDisk /dev/sdb: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("107.4")]),s._v(" GB, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("107374182400")]),s._v(" bytes, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("209715200")]),s._v(" sectors\nUnits "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sectors of "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" * "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nSector size "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("logical/physical"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes / "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nI/O size "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("minimum/optimal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes / "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\n\n\nDisk /dev/sda: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("42.9")]),s._v(" GB, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("42949672960")]),s._v(" bytes, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("83886080")]),s._v(" sectors\nUnits "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sectors of "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" * "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nSector size "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("logical/physical"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes / "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nI/O size "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("minimum/optimal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes / "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nDisk label type: dos\nDisk identifier: 0x000cbb0e\n\n   Device Boot      Start         End      Blocks   Id  System\n/dev/sda1   *        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2048")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2099199")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1048576")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("83")]),s._v("  Linux\n/dev/sda2         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2099200")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("83886079")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("40893440")]),s._v("   8e  Linux LVM\n\nDisk /dev/sdc: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("107.4")]),s._v(" GB, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("107374182400")]),s._v(" bytes, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("209715200")]),s._v(" sectors\nUnits "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sectors of "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" * "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nSector size "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("logical/physical"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes / "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nI/O size "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("minimum/optimal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes / "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\n\n\nDisk /dev/mapper/centos-root: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("37.7")]),s._v(" GB, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("37706792960")]),s._v(" bytes, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("73646080")]),s._v(" sectors\nUnits "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sectors of "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" * "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nSector size "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("logical/physical"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes / "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nI/O size "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("minimum/optimal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes / "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\n\n\nDisk /dev/mapper/centos-swap: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4160")]),s._v(" MB, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4160749568")]),s._v(" bytes, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8126464")]),s._v(" sectors\nUnits "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sectors of "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" * "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nSector size "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("logical/physical"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes / "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nI/O size "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("minimum/optimal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes / "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\n\n\nDisk /dev/mapper/vg-app: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("85.9")]),s._v(" GB, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("85899345920")]),s._v(" bytes, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("167772160")]),s._v(" sectors\nUnits "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sectors of "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" * "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nSector size "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("logical/physical"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes / "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\nI/O size "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("minimum/optimal"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes / "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v(" bytes\n")])])]),a("p",[s._v("第二步：扩容vg 将新的硬盘扩到vg卷组里，卸载"),a("code",[s._v("/app")])]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("umount")]),s._v(" /app\n")])])]),a("p",[s._v("执行命令"),a("code",[s._v("vgextend vg /dev/sdd")]),s._v(" 将新添加的硬盘"),a("code",[s._v("/dev/sdd")]),s._v("添加到vg卷组里")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vgextend vg /dev/sdd")]),s._v("\n  Physical volume "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/dev/sdd"')]),s._v(" successfully created.\n  Volume group "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"vg"')]),s._v(" successfully extended\n")])])]),a("p",[s._v("第三步：扩容lv 将逻辑卷"),a("code",[s._v("/dev/vg/app")]),s._v(" 扩展到350G，执行命令 "),a("code",[s._v("lvextend -L 11G /dev/vg/app")]),s._v(" 可以看到vg/app从原来的8G扩到了350G")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# lvextend -L 350G /dev/vg/app")]),s._v("\n  Size of logical volume vg/app changed from "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80.00")]),s._v(" GiB "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20480")]),s._v(" extents"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" to "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("350.00")]),s._v(" GiB "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("89600")]),s._v(" extents"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".\n  Logical volume vg/app successfully resized.\n")])])]),a("p",[s._v("第四步：同样检查硬盘（lv）完整性，并重置硬盘(lv)容量"),a("code",[s._v("e2fsck -f /dev/vg/app")]),s._v(" 检查硬盘完整性，"),a("code",[s._v("resize2fs /dev/vg/app")]),s._v(" 重置硬盘(lv)容量")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# umount /app")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# df -h")]),s._v("\nFilesystem               Size  Used Avail Use% Mounted on\ndevtmpfs                 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /dev\ntmpfs                    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /dev/shm\ntmpfs                    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(".6M  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("% /run\ntmpfs                    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /sys/fs/cgroup\n/dev/mapper/centos-root   35G  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".3G   32G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("% /\n/dev/sda1                976M  108M  802M  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v("% /boot\ntmpfs                    396M     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  396M   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /run/user/0\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# e2fsck -f /dev/vg/app")]),s._v("\ne2fsck "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.42")]),s._v(".9 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v("-Dec-2013"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nPass "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(": Checking inodes, blocks, and sizes\nPass "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(": Checking directory structure\nPass "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(": Checking directory connectivity\nPass "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(": Checking reference counts\nPass "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(": Checking group summary information\n/dev/vg/app: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v("/5242880 files "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("% non-contiguous"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("376182")]),s._v("/20971520 blocks\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# resize2fs /dev/vg/app")]),s._v("\nresize2fs "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.42")]),s._v(".9 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v("-Dec-2013"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nResizing the filesystem on /dev/vg/app to "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("91750400")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("4k"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" blocks.\nThe filesystem on /dev/vg/app is now "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("91750400")]),s._v(" blocks long.\n")])])]),a("p",[s._v("第五步：重新挂载硬盘并查看 "),a("code",[s._v("mount -a")]),s._v("并执行"),a("code",[s._v("df -h")]),s._v(" 可以看到/app已经成功扩容到350G了")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("div",{staticClass:"highlight-lines"},[a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("br"),a("div",{staticClass:"highlighted"},[s._v(" ")]),a("br")]),a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mount -a")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# df -h")]),s._v("\nFilesystem               Size  Used Avail Use% Mounted on\ndevtmpfs                 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /dev\ntmpfs                    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /dev/shm\ntmpfs                    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(".6M  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("% /run\ntmpfs                    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /sys/fs/cgroup\n/dev/mapper/centos-root   35G  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".3G   32G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("% /\n/dev/sda1                976M  108M  802M  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v("% /boot\ntmpfs                    396M     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  396M   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /run/user/0\n/dev/mapper/vg-app       345G   66M  327G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("% /app\n")])])]),a("h2",{attrs:{id:"缩小逻辑卷"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#缩小逻辑卷"}},[s._v("#")]),s._v(" 缩小逻辑卷")]),s._v(" "),a("p",[s._v("相对于逻辑卷扩容，缩小逻辑卷，数据丢失的风险更大。所以在生产环境中操作一定要注意提前备份好数据。在对LVM逻辑卷进行缩小操作之前，先把要缩小的文件系统卸载并检查文件系统的完整性。 现在我们将"),a("code",[s._v("/app")]),s._v("由现在的"),a("code",[s._v("350G")]),s._v("缩到"),a("code",[s._v("100G")])]),s._v(" "),a("p",[s._v("第一步：卸载"),a("code",[s._v("/app")]),s._v("并检查文件系统完整性")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# umount /app")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# e2fsck -f /dev/vg/app")]),s._v("\ne2fsck "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.42")]),s._v(".9 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v("-Dec-2013"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nPass "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(": Checking inodes, blocks, and sizes\nPass "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(": Checking directory structure\nPass "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(": Checking directory connectivity\nPass "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(": Checking reference counts\nPass "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(": Checking group summary information\n/dev/vg/app: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v("/22937600 files "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("% non-contiguous"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1489518")]),s._v("/91750400 blocks\n")])])]),a("p",[s._v("第二步：把逻辑卷缩容到100G，执行命令："),a("code",[s._v("resize2fs /dev/vg/app 100G")]),s._v("和"),a("code",[s._v("lvreduce -L 100G /dev/vg/app")])]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# resize2fs /dev/vg/app 100G")]),s._v("\nresize2fs "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.42")]),s._v(".9 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v("-Dec-2013"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nResizing the filesystem on /dev/vg/app to "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("26214400")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("4k"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" blocks.\nThe filesystem on /dev/vg/app is now "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("26214400")]),s._v(" blocks long.\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# lvreduce -L 100G /dev/vg/app")]),s._v("\n  WARNING: Reducing active logical volume to "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100.00")]),s._v(" GiB.\n  THIS MAY DESTROY YOUR DATA "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("filesystem etc."),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nDo you really want to reduce vg/app? "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("y/n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(": y\n  Size of logical volume vg/app changed from "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("350.00")]),s._v(" GiB "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("89600")]),s._v(" extents"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" to "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100.00")]),s._v(" GiB "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("25600")]),s._v(" extents"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".\n  Logical volume vg/app successfully resized.\n")])])]),a("p",[s._v("第三步：重新挂载并查看状态")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mount -a ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# df -h ")]),s._v("\nFilesystem               Size  Used Avail Use% Mounted on\ndevtmpfs                 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /dev\ntmpfs                    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /dev/shm\ntmpfs                    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(".6M  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("% /run\ntmpfs                    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".0G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /sys/fs/cgroup\n/dev/mapper/centos-root   35G  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".3G   32G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("% /\n/dev/sda1                976M  108M  802M  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v("% /boot\ntmpfs                    396M     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  396M   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("% /run/user/0\n/dev/mapper/vg-app        99G   60M   94G   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("% /app\n")])])]),a("p",[s._v("通过LVM的管理，创建、扩容、缩容，可以看到通过LVM技术可以实现系统存储空间的动态的调整。")]),s._v(" "),a("p",[s._v("基本原理是将多个物理硬盘创建成pv(物理卷)，这些物理卷是动态调整的物理基础，通过vg将pv管理起来形成一个整体的资源池。在vg中划分lv来动态调整逻辑卷的大小。")]),s._v(" "),a("p",[s._v("至此，CentOS7 LVM操作实战完成 (゜-゜)つロ 干杯~")])])}),[],!1,null,null,null);t.default=n.exports}}]);