(window.webpackJsonp=window.webpackJsonp||[]).push([[226],{694:function(a,s,t){"use strict";t.r(s);var r=t(29),e=Object(r.a)({},(function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"自己制作一个java11的docker镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#自己制作一个java11的docker镜像"}},[a._v("#")]),a._v(" 自己制作一个java11的docker镜像")]),a._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[a._v("提示")]),a._v(" "),t("p",[a._v("本教程基于ubuntu官方镜像，制作java11的docker镜像，仅供个人学习及测试使用。")])]),a._v(" "),t("h2",{attrs:{id:"资源准备"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#资源准备"}},[a._v("#")]),a._v(" 资源准备")]),a._v(" "),t("h3",{attrs:{id:"下载java11的jdk"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#下载java11的jdk"}},[a._v("#")]),a._v(" 下载java11的jdk")]),a._v(" "),t("p",[a._v("下载地址："),t("a",{attrs:{href:"https://www.oracle.com/java/technologies/javase-jdk11-downloads.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://www.oracle.com/java/technologies/javase-jdk11-downloads.html"),t("OutboundLink")],1)]),a._v(" "),t("p",[a._v("选择linux-64的版本："),t("strong",[a._v("jdk-11.0.11_linux-x64_bin.tar.gz")])]),a._v(" "),t("h2",{attrs:{id:"创建dockerfile文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建dockerfile文件"}},[a._v("#")]),a._v(" 创建Dockerfile文件")]),a._v(" "),t("p",[a._v("文件内容如下：")]),a._v(" "),t("div",{staticClass:"language-dockerfile extra-class"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("FROM")]),a._v(" ubuntu:focal")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("LABEL")]),a._v(" maintainer="),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"info@ieooc.com"')])]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ADD")]),a._v(" jdk-11.0.11_linux-x64_bin.tar.gz /usr/local")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("## 设置时区")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("RUN")]),a._v(" sed -i "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'s/archive.ubuntu.com/mirrors.aliyun.com/g'")]),a._v(" /etc/apt/sources.list "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("\\")]),a._v("\n          && apt-get update "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("\\")]),a._v("\n          && ln -snf /usr/share/zoneinfo/"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$TZ")]),a._v(" /etc/localtime && echo "),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$TZ")]),a._v(" > /etc/timezone "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("\\")]),a._v("\n          && apt-get install tzdata \\ ")]),a._v("\n          && apt-get clean \\\n          && apt-get autoclean \\\n          && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("## 设置JAVA环境变量")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ENV")]),a._v(" JAVA_HOME=/usr/local/jdk-11.0.11")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ENV")]),a._v(" PATH=.:"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$JAVA_HOME")]),a._v("/bin:"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$PATH")])]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("CMD")]),a._v(" ["),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/bin/bash"')]),a._v("]")]),a._v("\n")])])]),t("h2",{attrs:{id:"构建镜像-docker-build"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#构建镜像-docker-build"}},[a._v("#")]),a._v(" 构建镜像(docker build)")]),a._v(" "),t("p",[a._v("我这里"),t("code",[a._v("jdk-11.0.11_linux-x64_bin.tar.gz")]),a._v(" 和"),t("code",[a._v("Dockerfile")]),a._v("放在同一个目录下面的，直接用"),t("code",[a._v("docker build")]),a._v("指定当前路径即可")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" build -t 仓库路径xxx/java:11 "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(".")]),a._v("\n")])])]),t("p",[a._v("例如：")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" build -t ieooc/java:11-jdk "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(".")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("+"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" Building "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("31")]),a._v(".3s "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("8")]),a._v("/8"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" FINISHED\n "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("internal"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" load build definition from Dockerfile                       "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(".1s\n "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" transferring dockerfile: 684B                                       "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(".0s\n "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("internal"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" load .dockerignore                                          "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(".0s\n "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" transferring context: 2B                                            "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(".0s\n "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("internal"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" load metadata "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" docker.io/library/ubuntu:focal            "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(".0s\n "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("internal"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" load build context                                          "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("6")]),a._v(".7s\n "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" transferring context: "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("181")]),a._v(".76MB                                      "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("6")]),a._v(".7s\n "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("/3"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" FROM docker.io/library/ubuntu:focal                              "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(".1s\n "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" resolve docker.io/library/ubuntu:focal                              "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(".0s\n "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v("/3"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" ADD jdk-11.0.11_linux-x64_bin.tar.gz /usr/local                  "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("5")]),a._v(".3s\n "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),a._v("/3"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" RUN "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sed")]),a._v(" -i "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'s/archive.ubuntu.com/mirrors.aliyun.com/g'")]),a._v(" /etc/ap  "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("17")]),a._v(".1s\n "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" exporting to image                                                     "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(".0s\n "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" exporting layers                                                    "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(".0s\n "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" writing image sha256:a1acc660560e92203cca1ecdcc4ff1fd88098e8f1133a  "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(".0s\n "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" naming to docker.io/ieooc/java:11-jdk                               "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(".0s\n")])])]),t("p",[a._v("查看构建结果：")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" images\nREPOSITORY          TAG        IMAGE ID       CREATED              SIZE\nieooc/java          "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("11")]),a._v("-jdk     a1acc660560e   About a minute ago   383MB\n")])])]),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"custom-block-title"},[a._v("注意")]),a._v(" "),t("p",[a._v("后面的"),t("code",[a._v(".")]),a._v("表示当前路径，如果不是当前路径需要用"),t("code",[a._v("-f")]),a._v("指定")])]),a._v(" "),t("h2",{attrs:{id:"推送到远程仓库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#推送到远程仓库"}},[a._v("#")]),a._v(" 推送到远程仓库")]),a._v(" "),t("p",[a._v("前面如果"),t("code",[a._v("-t")]),a._v("指定了仓库的路径，则直接使用"),t("code",[a._v("docker push")]),a._v("即可 ，否则用"),t("code",[a._v("docker tag")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" push ieooc/java:11-jdk\n")])])]),t("h2",{attrs:{id:"推送至本地私服harbor"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#推送至本地私服harbor"}},[a._v("#")]),a._v(" 推送至本地私服harbor")]),a._v(" "),t("p",[a._v("重新打tag")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" tag ieooc/java:11-jdk harbor.ieooc.com/library/java:11-jdk\n")])])]),t("p",[a._v("开始推送")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" push harbor.ieooc.com/library/java:11-jdk\n")])])]),t("h2",{attrs:{id:"测试"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#测试"}},[a._v("#")]),a._v(" 测试")]),a._v(" "),t("p",[a._v("（1）测试ubuntu时区：进入容器输入"),t("code",[a._v("date")])]),a._v(" "),t("p",[a._v("（2）测试java环境：进入容器输入"),t("code",[a._v("java -version")])]),a._v(" "),t("p",[a._v("（3）测试jdk时区：编写一个"),t("code",[a._v(".java")]),a._v("文件，里面打印"),t("code",[a._v("LocalDateTime")]),a._v("打印时间")])])}),[],!1,null,null,null);s.default=e.exports}}]);