(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{511:function(a,s,t){"use strict";t.r(s);var e=t(29),r=Object(e.a)({},(function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"centos-7-安装-sonarqube"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#centos-7-安装-sonarqube"}},[a._v("#")]),a._v(" CentOS 7 安装 SonarQube")]),a._v(" "),t("h2",{attrs:{id:"概述"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#概述"}},[a._v("#")]),a._v(" 概述")]),a._v(" "),t("p",[a._v("Sonar（SonarQube）是一个开源平台，用于管理源代码的质量。Sonar 不只是一个质量数据报告工具，更是代码质量管理平台。支持的语言包括：Java、PHP、C#、C、Cobol、PL/SQL、Flex 等。")]),a._v(" "),t("h2",{attrs:{id:"前置条件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#前置条件"}},[a._v("#")]),a._v(" 前置条件")]),a._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[a._v("提示")]),a._v(" "),t("p",[t("strong",[a._v("SonarQube")]),a._v(" 依赖后端数据存储，本教程选择 "),t("strong",[a._v("MySQL")]),a._v(" 作为后端数据存储。")])]),a._v(" "),t("h3",{attrs:{id:"查看mysql引擎"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看mysql引擎"}},[a._v("#")]),a._v(" 查看MySQL引擎")]),a._v(" "),t("p",[a._v("结合 "),t("strong",[a._v("SonarQube")]),a._v("，MySQL 数据库最好使用 InnoDB 引擎，可提高性能。 看你的 mysql 现在已提供什么存储引擎:")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("mysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" show engines"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("h3",{attrs:{id:"看你的-mysql-当前默认的存储引擎"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#看你的-mysql-当前默认的存储引擎"}},[a._v("#")]),a._v(" 看你的 mysql 当前默认的存储引擎:")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("mysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" show variables like "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'%storage_engine%'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("p",[a._v("如果查询的结果和上图显示的效果不一致，需要做一下配置：")]),a._v(" "),t("h3",{attrs:{id:"修改-mysql-存储引擎为-innodb"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#修改-mysql-存储引擎为-innodb"}},[a._v("#")]),a._v(" 修改 MySQL 存储引擎为 InnoDB")]),a._v(" "),t("p",[a._v("编辑MySQL配置文件 "),t("code",[a._v("/etc/my.cnf")]),a._v("找到"),t("code",[a._v("[mysqld]")]),a._v("下面加入"),t("code",[a._v("default-storage-engine=INNODB")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("vi")]),a._v(" /etc/my.cnf\n")])])]),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("[mysqld]\ndefault-storage-engine = INNODB\n")])])]),t("h3",{attrs:{id:"重启-mysql-服务器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#重启-mysql-服务器"}},[a._v("#")]),a._v(" 重启 mysql 服务器")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("systemctl restart mysql.service\n")])])]),t("h3",{attrs:{id:"再次登录-mysql-查看默认引擎设置是否生效"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#再次登录-mysql-查看默认引擎设置是否生效"}},[a._v("#")]),a._v(" 再次登录 MySQL 查看默认引擎设置是否生效")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("mysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" show variables like "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'%storage_engine%'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("h2",{attrs:{id:"配置innodb-buffer-pool-size"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置innodb-buffer-pool-size"}},[a._v("#")]),a._v(" 配置innodb_buffer_pool_size")]),a._v(" "),t("p",[t("code",[a._v("innodb_buffer_pool_size")]),a._v(" 参数值设置得尽可能大一点 这个参数主要作用是缓存 innodb 表的索引，数据，插入数据时的缓冲 默认值:128M，专用 mysql 服务器设置的大小:操作系统内存的 70%-80%最佳。")]),a._v(" "),t("p",[a._v("设置方法:my.cnf 文件"),t("code",[a._v("[mysqld]")]),a._v(" 下面加入 "),t("code",[a._v("innodb_buffer_pool_size")]),a._v(" 参数")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("vi")]),a._v(" /etc/my.cnf\n")])])]),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("[mysqld]\ninnodb_buffer_pool_size=256M\n")])])]),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[a._v("提示")]),a._v(" "),t("p",[a._v("我们这里设置为 256M，因为我们的不是专用的 MySQL 数据库服务器，还有很多其他的服务需要占用系统内存")])]),a._v(" "),t("h2",{attrs:{id:"配置query-cache-size"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置query-cache-size"}},[a._v("#")]),a._v(" 配置query_cache_size")]),a._v(" "),t("h3",{attrs:{id:"设置-mysql-的查询缓存-query-cache-size-最少设置-15m"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#设置-mysql-的查询缓存-query-cache-size-最少设置-15m"}},[a._v("#")]),a._v(" 设置 MySQL 的查询缓存 query_cache_size, 最少设置 15M")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("vi")]),a._v(" /etc/my.cnf\n")])])]),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("[mysqld]\nquery_cache_type=1\nquery_cache_size=32M\n")])])]),t("h3",{attrs:{id:"重启-mysql-服务器-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#重启-mysql-服务器-2"}},[a._v("#")]),a._v(" 重启 mysql 服务器")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("systemctl restart mysql.service\n")])])]),t("h3",{attrs:{id:"验证缓存设置是否生效"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#验证缓存设置是否生效"}},[a._v("#")]),a._v(" 验证缓存设置是否生效:")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("mysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" show variables like "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'%query_cache%'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" \n")])])]),t("h2",{attrs:{id:"创建-sonarqube-数据库-utf-8-编码"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建-sonarqube-数据库-utf-8-编码"}},[a._v("#")]),a._v(" 创建 sonarqube 数据库(UTF-8 编码)")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("mysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" CREATE SCHEMA "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")]),a._v("sonar"),t("span",{pre:!0,attrs:{class:"token variable"}},[a._v("`")])]),a._v(" DEFAULT CHARACTER SET utf8"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("h2",{attrs:{id:"下载-sonarqube"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#下载-sonarqube"}},[a._v("#")]),a._v(" 下载 SonarQube")]),a._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[a._v("提示")]),a._v(" "),t("p",[a._v("下载地址: "),t("a",{attrs:{href:"http://www.sonarqube.org/downloads/",target:"_blank",rel:"noopener noreferrer"}},[a._v("http://www.sonarqube.org/downloads/"),t("OutboundLink")],1),a._v(" 下载"),t("code",[a._v("SonarQube 6.7.7")]),a._v("版本")])]),a._v(" "),t("h3",{attrs:{id:"切换到普通用户"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#切换到普通用户"}},[a._v("#")]),a._v(" 切换到普通用户")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("$ "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" /home/heyuqiang\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("wget")]),a._v(" https://binaries.sonarsource.com/Distribution/sonarqube/sonarqube-6.7.7.zip\n")])])]),t("h3",{attrs:{id:"解压安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#解压安装"}},[a._v("#")]),a._v(" 解压安装")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("unzip")]),a._v(" sonarqube-6.7.7.zip\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("mv")]),a._v(" sonarqube-6.7.7 sonarqube\n")])])]),t("h2",{attrs:{id:"配置-sonarqube"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置-sonarqube"}},[a._v("#")]),a._v(" 配置 SonarQube")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("vi")]),a._v(" /home/heyuqiang/sonarqube/conf/sonar.properties\n")])])]),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("sonar.jdbc.username=root # MySQL用户名\nsonar.jdbc.password=root # MySQL密码\n#----- MySQL 5.6 or greater\n# Only InnoDB storage engine is supported (not myISAM).\n# Only the bundled driver is supported. It can not be changed.\nsonar.jdbc.url=jdbc:mysql://mysql-ip:3306/sonarqube?useUnicode=true&characterEncoding=utf8&rewriteBatchedStatements=true&useConfigs=maxPerformance&useSSL=false\nsonar.web.host=0.0.0.0\nsonar.web.context=/sonar\nsonar.web.port=9000\n")])])]),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"custom-block-title"},[a._v("注意")]),a._v(" "),t("p",[a._v("保存以上配置(注意，要看看默认的 9000 端口是否已被占用)")])]),a._v(" "),t("h2",{attrs:{id:"启动和测试"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动和测试"}},[a._v("#")]),a._v(" 启动和测试")]),a._v(" "),t("h3",{attrs:{id:"切换到普通用户启动sonarqube-web-server"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#切换到普通用户启动sonarqube-web-server"}},[a._v("#")]),a._v(" 切换到普通用户启动SonarQube Web Server")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("$ /home/heyuqiang/sonarqube/bin/linux-x86-64/sonar.sh start\n")])])]),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[a._v("提示")]),a._v(" "),t("p",[a._v("初次启动会自动建表和做相应的初始化")])]),a._v(" "),t("h3",{attrs:{id:"查看日志"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看日志"}},[a._v("#")]),a._v(" 查看日志")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("tail")]),a._v(" -f /home/heyuqiang/sonarqube/logs/sonar.log\n")])])]),t("h2",{attrs:{id:"初次登录-sonarqube-设置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#初次登录-sonarqube-设置"}},[a._v("#")]),a._v(" 初次登录 SonarQube 设置")]),a._v(" "),t("p",[a._v("sonarqube默认用户名："),t("code",[a._v("admin")]),a._v(" 密码："),t("code",[a._v("admin")]),a._v("，浏览器访问：http://server-ip:9000/sonarqube/")]),a._v(" "),t("h2",{attrs:{id:"设置-sonarqube-开机启动"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#设置-sonarqube-开机启动"}},[a._v("#")]),a._v(" 设置 SonarQube 开机启动")]),a._v(" "),t("h3",{attrs:{id:"使用root用户编辑-etc-rc-local文件-执行命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用root用户编辑-etc-rc-local文件-执行命令"}},[a._v("#")]),a._v(" 使用root用户编辑/etc/rc.local文件，执行命令：")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# vi /etc/rc.local")]),a._v("\n")])])]),t("p",[a._v("加入：")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("## sonarqube")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("su")]),a._v(" - heyuqiang -c "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'/home/heyuqiang/sonarqube/bin/linux-x86-64/sonar.sh start'")]),a._v("\n")])])]),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[a._v("提示")]),a._v(" "),t("p",[a._v("第一次使用开机启动时需要为"),t("code",[a._v("/etc/rc.local")]),a._v(" 文件赋权限")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("chmod")]),a._v(" +x /etc/rc.local\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("chmod")]),a._v(" +x /etc/rc.d/rc.local\n")])])])]),a._v(" "),t("p",[a._v("至此，SonarQube部署完成 (゜-゜)つロ 干杯~")])])}),[],!1,null,null,null);s.default=r.exports}}]);