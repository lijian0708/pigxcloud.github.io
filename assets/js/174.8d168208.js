(window.webpackJsonp=window.webpackJsonp||[]).push([[174],{643:function(a,s,t){"use strict";t.r(s);var e=t(29),r=Object(e.a)({},(function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"docker磁盘空间不足解决办法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker磁盘空间不足解决办法"}},[a._v("#")]),a._v(" docker磁盘空间不足解决办法")]),a._v(" "),t("h2",{attrs:{id:"导入docker镜像时-错误提示-磁盘空间不足。"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#导入docker镜像时-错误提示-磁盘空间不足。"}},[a._v("#")]),a._v(" 导入docker镜像时，错误提示：磁盘空间不足。")]),a._v(" "),t("p",[a._v("1.查看docker镜像存放目录空间大小")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("du")]),a._v(" -hs /var/lib/docker/\n")])])]),t("p",[a._v("2.停止docker服务。")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("systemctl stop "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v("\n")])])]),t("p",[a._v("3.查看磁盘容量大的空间，且在上面创建新的docker目录。")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("df")]),a._v(" -h\n"),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" -p /data/docker/lib\n")])])]),t("p",[a._v("4.迁移"),t("code",[a._v("/var/lib/docker")]),a._v("目录下的文件到新创建的目录"),t("code",[a._v("/data/docker/lib")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("rsync")]),a._v(" -avz /var/lib/docker /data/docker/lib/\n")])])]),t("p",[a._v("5.编辑 "),t("code",[a._v("/etc/docker/daemon.json")]),a._v(" 添加如下参数")]),a._v(" "),t("div",{staticClass:"language-json extra-class"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[a._v('"graph"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/data/docker/lib/docker"')]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),t("p",[a._v("6.重新加载docker，并重启docker服务。")]),a._v(" "),t("div",{staticClass:"language-css extra-class"},[t("pre",{pre:!0,attrs:{class:"language-css"}},[t("code",[a._v("systemctl daemon-reload && systemctl restart docker\n")])])]),t("p",[a._v("7.检查docker是否变更为新目录"),t("code",[a._v("/data/docker/lib/docker")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@localhost ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# docker info")]),a._v("\n\nDocker Root Dir: /data/docker/lib/docker\n\nDebug Mode "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("client"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(": "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("false")]),a._v("\n\nDebug Mode "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("server"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(": "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("false")]),a._v("\n\nRegistry: https://index.docker.io/v1/\n")])])]),t("p",[a._v("8.删掉docker旧目录")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("rm")]),a._v(" -rf /var/lib/docker\n")])])]),t("h2",{attrs:{id:"常见docker清理方法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#常见docker清理方法"}},[a._v("#")]),a._v(" 常见docker清理方法")]),a._v(" "),t("ul",[t("li",[t("p",[t("strong",[a._v("docker system df")]),a._v(" 类似于Linux上的"),t("strong",[a._v("df")]),a._v("命令，用于查看Docker的磁盘使用情况:")])]),a._v(" "),t("li",[t("p",[t("strong",[a._v("docker system prune")]),a._v(" 可以用于清理磁盘，删除关闭的容器、无用的数据卷和网络，以及dangling镜像(即无tag的镜像)。")])]),a._v(" "),t("li",[t("p",[t("strong",[a._v("docker system prune -a")]),a._v(" 清理得更加彻底，可以将没有容器使用Docker镜像都删掉。注意，这两个命令会把你暂时关闭的容器，以及暂时没有用到的Docker镜像都删掉了…所以使用之前一定要想清楚.。我没用过，因为会清理 没有开启的 Docker")])])])])}),[],!1,null,null,null);s.default=r.exports}}]);